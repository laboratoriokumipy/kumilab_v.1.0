<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratorios Kumi - Cat√°logo Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* [ESTILOS PREVIOS MANTENIDOS] */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #020817 0%, #0f172a 100%); color: #e5e7eb; min-height: 100vh; }
        .container { max-width: 1280px; margin: 0 auto; padding: 0 1rem; }
        
        /* [ESTILOS HEADER ACTUALIZADOS] */
        .header { position: sticky; top: 0; z-index: 50; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(31, 41, 55, 0.5); }
        .header-content { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; }
        .logo { display: flex; align-items: center; gap: 0.75rem; }
        .logo-icon { width: 48px; height: 48px; background: linear-gradient(135deg, #22c55e, #16a34a); border-radius: 50%; display: flex; align-items: center; justify-content: center; position: relative; }
        .logo-icon::before { content: ''; position: absolute; width: 24px; height: 24px; background: transparent; border: 3px solid #020817; border-radius: 50%; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .logo-icon::after { content: 'üåø'; position: absolute; font-size: 16px; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .logo-text h1 { font-size: 1.5rem; font-weight: 700; color: #f3f4f6; }
        .logo-text p { font-size: 0.75rem; color: #22c55e; font-weight: 500; }
        .nav-buttons { display: flex; gap: 1rem; align-items: center; }
        .nav-btn { position: relative; padding: 0.5rem; background: rgba(31, 41, 55, 0.8); border: 1px solid rgba(31, 41, 55, 0.8); border-radius: 8px; color: #d1d5db; cursor: pointer; transition: all 0.2s; }
        .nav-btn:hover { background: rgba(55, 65, 81, 0.8); transform: translateY(-1px); }
        .nav-btn.admin-btn { background: linear-gradient(135deg, #f59e0b, #d97706); color: #020817; border: none; }
        .nav-btn.admin-btn:hover { box-shadow: 0 10px 15px -3px rgba(245, 158, 11, 0.3); }
        .admin-badge { position: absolute; top: -8px; right: -8px; background: #ef4444; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 600; }
        .badge { position: absolute; top: -8px; right: -8px; background: #22c55e; color: #020817; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 600; }

        /* [RESTO DE ESTILOS PREVIOS MANTENIDOS] */
        .hero { padding: 2rem 0; }
        .hero-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
        @media (min-width: 1024px) { .hero-grid { grid-template-columns: 2fr 1fr; } }
        .hero-card, .about-card, .filters-card, .product-card, .metrics-card { background: rgba(11, 16, 32, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(31, 41, 55, 0.5); border-radius: 16px; padding: 2rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3); }
        .hero-title { font-size: 2.5rem; font-weight: 700; color: #f3f4f6; margin-bottom: 1rem; background: linear-gradient(135deg, #22c55e, #16a34a); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .hero-subtitle { font-size: 1.25rem; color: #22c55e; font-weight: 500; margin-bottom: 1rem; }
        .hero-description { color: #9ca3af; margin-bottom: 1.5rem; line-height: 1.6; }
        .hero-tags { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1.5rem; }
        .tag { padding: 0.25rem 0.75rem; background: rgba(31, 41, 55, 0.8); border: 1px solid rgba(31, 41, 55, 0.8); border-radius: 9999px; font-size: 0.75rem; color: #d1d5db; display: flex; align-items: center; gap: 0.25rem; }
        .tag i { color: #22c55e; }
        .btn { padding: 0.5rem 1rem; border-radius: 8px; font-weight: 500; cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem; border: none; }
        .btn-primary { background: linear-gradient(135deg, #22c55e, #16a34a); color: #020817; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(34, 197, 94, 0.3); }
        .btn-outline { background: transparent; color: #d1d5db; border: 1px solid rgba(31, 41, 55, 0.8); }
        .btn-outline:hover { background: rgba(31, 41, 55, 0.8); }
        .btn-danger { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
        .btn-warning { background: linear-gradient(135deg, #f59e0b, #d97706); color: #020817; }

        /* [ESTILOS PRODUCTOS PREVIOS] */
        .products { padding: 2rem 0; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem; }
        .product-image-container { position: relative; height: 192px; background: linear-gradient(135deg, #1f2937, #111827); }
        .product-badge { position: absolute; top: 0.5rem; left: 0.5rem; padding: 0.25rem 0.5rem; background: rgba(34, 197, 94, 0.2); border: 1px solid rgba(34, 197, 94, 0.4); border-radius: 9999px; font-size: 0.75rem; font-weight: 500; color: #22c55e; }
        .product-image { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
        .product-card:hover .product-image { transform: scale(1.05); }
        .product-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent); opacity: 0; transition: opacity 0.3s; display: flex; align-items: flex-end; padding: 0.75rem; }
        .product-card:hover .product-overlay { opacity: 1; }
        .overlay-actions { display: flex; gap: 0.5rem; width: 100%; }
        .overlay-btn { flex: 1; padding: 0.5rem; background: #22c55e; color: #020817; border: none; border-radius: 8px; font-weight: 500; font-size: 0.875rem; cursor: pointer; transition: background 0.2s; }
        .overlay-btn:hover { background: #16a34a; }
        .overlay-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .product-content { padding: 1rem; }
        .product-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .product-category { font-size: 0.75rem; font-weight: 500; color: #06b6d4; }
        .product-price { font-size: 0.875rem; font-weight: 700; color: #22c55e; }
        .product-name { font-size: 0.875rem; font-weight: 600; color: #f3f4f6; margin-bottom: 0.5rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .product-description { font-size: 0.75rem; color: #6b7280; margin-bottom: 0.75rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .product-tags { display: flex; flex-wrap: wrap; gap: 0.25rem; margin-bottom: 0.75rem; }
        .product-tag { padding: 0.125rem 0.5rem; background: rgba(31, 41, 55, 0.8); border: 1px solid rgba(31, 41, 55, 0.8); border-radius: 9999px; font-size: 0.625rem; color: #6b7280; }

        /* [BOTONES DE ADMIN EN PRODUCTOS] */
        .admin-product-actions { display: flex; gap: 0.5rem; padding-top: 0.5rem; border-top: 1px solid rgba(239, 68, 68, 0.3); }
        .admin-btn-edit { background: rgba(245, 158, 11, 0.2); border: 1px solid #f59e0b; color: #f59e0b; }
        .admin-btn-edit:hover { background: rgba(245, 158, 11, 0.3); }
        .admin-btn-delete { background: rgba(239, 68, 68, 0.2); border: 1px solid #ef4444; color: #ef4444; }
        .admin-btn-delete:hover { background: rgba(239, 68, 68, 0.3); }

        /* [MODALES PREVIOS MANTENIDOS] */
        .modal { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; visibility: hidden; transition: all 0.3s; padding: 1rem; }
        .modal.show { opacity: 1; visibility: visible; }
        .modal-content { background: #0b1020; border-radius: 16px; padding: 1.5rem; max-width: 90%; max-height: 90%; overflow-y: auto; border: 1px solid rgba(31, 41, 55, 0.5); transform: scale(0.9); transition: transform 0.3s; }
        .modal.show .modal-content { transform: scale(1); }
        @media (min-width: 768px) { .modal-content { max-width: 600px; } }
        .modal-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem; }
        .modal-title { font-size: 1.5rem; font-weight: 700; color: #f3f4f6; }
        .modal-close { background: transparent; border: none; color: #6b7280; font-size: 1.25rem; cursor: pointer; transition: color 0.2s; }
        .modal-close:hover { color: #f3f4f6; }

        /* [ESTILOS FORMULARIO ADMIN] */
        .form-group { margin-bottom: 1rem; }
        .form-label { display: block; font-size: 0.875rem; font-weight: 500; color: #d1d5db; margin-bottom: 0.5rem; }
        .form-input, .form-textarea, .form-select { width: 100%; padding: 0.5rem 0.75rem; background: rgba(31, 41, 55, 0.8); border: 1px solid rgba(31, 41, 55, 0.8); border-radius: 8px; color: #f3f4f6; font-size: 0.875rem; resize: vertical; }
        .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: #22c55e; }
        .form-textarea { min-height: 80px; }
        .form-hint { font-size: 0.75rem; color: #6b7280; margin-top: 0.25rem; }
        .form-actions { display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem; }
        .checkbox-group { display: flex; align-items: center; gap: 0.5rem; }
        .checkbox-group input[type="checkbox"] { width: auto; }

        /* [BOT√ìN FLOTANTE AGREGAR PRODUCTO] */
        .fab-add-product { position: fixed; bottom: 2rem; right: 2rem; width: 56px; height: 56px; background: linear-gradient(135deg, #f59e0b, #d97706); border: none; border-radius: 50%; color: #020817; font-size: 1.5rem; cursor: pointer; box-shadow: 0 10px 15px -3px rgba(245, 158, 11, 0.3); transition: all 0.3s; z-index: 100; }
        .fab-add-product:hover { transform: scale(1.1); box-shadow: 0 20px 25px -5px rgba(245, 158, 11, 0.4); }
        .fab-add-product.hide { opacity: 0; visibility: hidden; }

        /* [LOGIN MODAL ESTILOS] */
        .login-form { max-width: 400px; margin: 0 auto; }
        .login-logo { text-align: center; margin-bottom: 1.5rem; }
        .login-logo .logo-icon { width: 64px; height: 64px; margin: 0 auto; }
        .login-title { text-align: center; margin-bottom: 0.5rem; color: #f3f4f6; }
        .login-subtitle { text-align: center; color: #9ca3af; margin-bottom: 1.5rem; font-size: 0.875rem; }
        .login-error { background: rgba(239, 68, 68, 0.2); border: 1px solid #ef4444; color: #fecaca; padding: 0.5rem; border-radius: 8px; margin-bottom: 1rem; font-size: 0.875rem; display: none; }
        .login-error.show { display: block; }

        /* [ESTADOS DE CARGA] */
        .loading { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 4rem 0; }
        .loading-spinner { width: 48px; height: 48px; border: 3px solid rgba(31, 41, 55, 0.3); border-radius: 50%; border-top: 3px solid #22c55e; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .loading-text { margin-top: 1rem; color: #9ca3af; }
        .empty-state { text-align: center; padding: 4rem 0; display: none; }
        .empty-state.show { display: block; }
        .empty-icon { width: 80px; height: 80px; margin: 0 auto 1rem; background: rgba(31, 41, 55, 0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .empty-icon i { font-size: 2rem; color: #6b7280; }
        .empty-title { font-size: 1.25rem; font-weight: 600; color: #f3f4f6; margin-bottom: 0.5rem; }
        .empty-description { color: #9ca3af; }

        /* [TOAST] */
        .toast { position: fixed; bottom: 1rem; right: 1rem; padding: 1rem; background: #0b1020; border: 1px solid rgba(31, 41, 55, 0.5); border-radius: 8px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5); z-index: 2000; transform: translateX(400px); transition: transform 0.3s; max-width: 300px; }
        .toast.show { transform: translateX(0); }
        .toast-content { display: flex; align-items: center; gap: 0.75rem; }
        .toast-icon { width: 20px; height: 20px; border-radius: 50%; background: #22c55e; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .toast-icon i { font-size: 0.75rem; color: #020817; }
        .toast-message { color: #f3f4f6; font-size: 0.875rem; }
        .toast-error .toast-icon { background: #ef4444; }
        .toast-warning .toast-icon { background: #f59e0b; }

        /* Responsive */
        @media (max-width: 640px) {
            .hero-title { font-size: 1.5rem; }
            .products-grid { grid-template-columns: 1fr; }
            .fab-add-product { bottom: 1rem; right: 1rem; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon"></div>
                    <div class="logo-text">
                        <h1>Laboratorios Kumi</h1>
                        <p>Productos Fitoterap√©uticos</p>
                    </div>
                </div>
                <nav class="nav-buttons">
                    <button class="nav-btn admin-btn" id="adminBtn" onclick="handleAdminAction()">
                        <i class="fas fa-user-shield"></i>
                        <span id="adminBtnText">Admin</span>
                        <span class="admin-badge" id="adminBadge" style="display: none;">!</span>
                    </button>
                    <button class="nav-btn" onclick="toggleCart()">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="badge" id="cartBadge">0</span>
                    </button>
                    <button class="nav-btn" onclick="toggleWishlist()">
                        <i class="fas fa-heart"></i>
                        <span class="badge" id="wishlistBadge">0</span>
                    </button>
                </nav>
            </div>
        </div>
    </header>

    <!-- [SECCIONES PREVIAS MANTENIDAS] -->
    <section class="hero"><div class="container"><div class="hero-grid">
        <div class="hero-card">
            <h2 class="hero-title">Cat√°logo de Productos Fitoterap√©uticos</h2>
            <p class="hero-subtitle">Calidad y Naturaleza en Cada Producto</p>
            <p class="hero-description">Descubra nuestra l√≠nea de productos fitoterap√©uticos elaborados con las mejores plantas medicinales. Contamos con certificaci√≥n DINAVISA RE N¬∞ 4045 y procesos de fabricaci√≥n que garantizan la m√°xima calidad.</p>
            <div class="hero-tags">
                <span class="tag"><i class="fas fa-certificate"></i>Certificado DINAVISA</span>
                <span class="tag"><i class="fas fa-leaf"></i>100% Natural</span>
                <span class="tag"><i class="fas fa-flask"></i>Control de Calidad</span>
                <span class="tag"><i class="fas fa-globe"></i>Exportaci√≥n</span>
            </div>
            <div class="hero-buttons">
                <a href="#productos" class="btn btn-primary"><i class="fas fa-search"></i>Explorar productos</a>
                <a href="#about" class="btn btn-outline"><i class="fas fa-info-circle"></i>Con√≥cenos</a>
            </div>
        </div>
        <div class="hero-card metrics-card">
            <h3>Resumen del Cat√°logo</h3>
            <div class="metric-item"><span class="metric-label">Productos Activos</span><span class="metric-value green" id="totalProducts">0</span></div>
            <div class="metric-item"><span class="metric-label">Categor√≠as</span><span class="metric-value cyan" id="totalCategories">0</span></div>
            <div class="metric-item"><span class="metric-label">En Carrito</span><span class="metric-value cyan" id="cartCount">0</span></div>
            <div class="metric-item"><span class="metric-label">Certificaci√≥n</span><span class="metric-value green" style="font-size: 1rem;">DINAVISA</span></div>
        </div>
    </div></div></section>

    <section class="about-section" id="about"><div class="container"><div class="about-card">
        <h2 class="about-title">¬øQui√©nes Somos?</h2>
        <div class="about-content">
            <div class="about-text">
                <h3>Laboratorios Kumi E.A.S.</h3>
                <p>Somos una empresa emergente dedicada al rubro de productos fitoterap√©uticos, habilitada por la Direcci√≥n Nacional de Vigilancia Sanitaria (DINAVISA) bajo el RE N¬∞ 4045.</p>
                <p>Nuestra infraestructura propia permite el fraccionamiento y envasado de productos fitoterap√©uticos, espec√≠ficamente plantas medicinales, facilitando la producci√≥n de una amplia variedad de productos como polvo para infusiones, mate o terer√©, extractos y t√©s.</p>
                <p>Contamos con dep√≥sitos habilitados para el almacenamiento de productos fitoterap√©uticos importados, como t√©s, c√°psulas, jarabes y otros productos derivados de plantas medicinales.</p>
            </div>
            <div class="about-features">
                <div class="feature-item"><div class="feature-icon"><i class="fas fa-users"></i></div><div class="feature-text"><h4>Equipo Profesional</h4><p>Profesionales del √°rea de la Qu√≠mica con amplia experiencia</p></div></div>
                <div class="feature-item"><div class="feature-icon"><i class="fas fa-cogs"></i></div><div class="feature-text"><h4>Sistemas de Calidad</h4><p>Implementaci√≥n de Buenas Pr√°cticas de Fabricaci√≥n</p></div></div>
                <div class="feature-item"><div class="feature-icon"><i class="fas fa-microscope"></i></div><div class="feature-text"><h4>Control de Calidad</h4><p>An√°lisis de plantas medicinales y metabolitos secundarios</p></div></div>
                <div class="feature-item"><div class="feature-icon"><i class="fas fa-graduation-cap"></i></div><div class="feature-text"><h4>Consultor√≠a</h4><p>Regencia y asesoramiento t√©cnico especializado</p></div></div>
            </div>
        </div>
        <div class="certifications">
            <h4><i class="fas fa-certificate"></i>Certificaciones y Servicios Autorizados</h4>
            <div class="cert-list">
                <div class="cert-item"><i class="fas fa-check-circle"></i><span>Representante de Productos Fitoterap√©uticos</span></div>
                <div class="cert-item"><i class="fas fa-check-circle"></i><span>Distribuidora de Productos Fitoterap√©uticos</span></div>
                <div class="cert-item"><i class="fas fa-check-circle"></i><span>Fraccionadora y Envasadora</span></div>
                <div class="cert-item"><i class="fas fa-check-circle"></i><span>Exportadora de Productos Fitoterap√©uticos</span></div>
                <div class="cert-item"><i class="fas fa-check-circle"></i><span>Importadora de Productos Fitoterap√©uticos</span></div>
                <div class="cert-item"><i class="fas fa-check-circle"></i><span>Regencia de Establecimientos Farmac√©uticos</span></div>
            </div>
        </div>
    </div></div></section>

    <section class="filters" id="productos"><div class="container"><div class="filters-card">
        <div class="filters-top">
            <div class="search-box"><i class="fas fa-search"></i><input type="text" class="search-input" placeholder="Buscar por nombre, categor√≠a, etiqueta..." id="searchInput" oninput="filterProducts()"></div>
            <select class="sort-select" id="sortSelect" onchange="filterProducts()">
                <option value="relevance">Relevancia</option>
                <option value="name_asc">Nombre A-Z</option>
                <option value="name_desc">Nombre Z-A</option>
                <option value="price_asc">Precio: Menor a Mayor</option>
                <option value="price_desc">Precio: Mayor a Menor</option>
            </select>
        </div>
        <div class="category-chips" id="categoryChips"></div>
        <div class="filters-summary">
            <span id="resultsCount">0 producto(s) encontrado(s)</span>
            <button class="clear-filters" onclick="clearFilters()">Limpiar filtros</button>
        </div>
    </div></div></section>

    <section class="products"><div class="container">
        <div id="loadingState" class="loading"><div class="loading-spinner"></div><p class="loading-text">Cargando cat√°logo de productos...</p></div>
        <div id="productsGrid" class="products-grid" style="display: none;"></div>
        <div id="emptyState" class="empty-state"><div class="empty-icon"><i class="fas fa-search"></i></div><h3 class="empty-title">No se encontraron productos</h3><p class="empty-description">Intenta ajustar tus filtros o buscar con otros t√©rminos</p></div>
    </div></section>

    <!-- Bot√≥n Flotante Agregar Producto (Admin) -->
    <button class="fab-add-product hide" id="fabAddProduct" onclick="showAddProductModal()" title="Agregar Producto">
        <i class="fas fa-plus"></i>
    </button>

    <!-- [MODALES PREVIOS MANTENIDOS] -->
    <div id="productModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title" id="modalTitle"></h2><button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button></div><div class="modal-body" id="modalBody"></div></div></div>
    <div id="cartModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title">Tu Carrito</h2><button class="modal-close" onclick="toggleCart()"><i class="fas fa-times"></i></button></div><div id="cartContent"></div></div></div>
    <div id="wishlistModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title">Tus Favoritos</h2><button class="modal-close" onclick="toggleWishlist()"><i class="fas fa-times"></i></button></div><div id="wishlistContent"></div></div></div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="login-form">
                <div class="login-logo">
                    <div class="logo-icon"></div>
                </div>
                <h2 class="login-title">Acceso Administrador</h2>
                <p class="login-subtitle">Ingrese sus credenciales para gestionar productos</p>
                <div class="login-error" id="loginError"></div>
                <div class="form-group">
                    <label class="form-label">Usuario</label>
                    <input type="text" class="form-input" id="loginUsername" placeholder="Usuario" autofocus>
                </div>
                <div class="form-group">
                    <label class="form-label">Contrase√±a</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="Contrase√±a">
                </div>
                <div class="form-actions">
                    <button class="btn btn-outline" onclick="closeLoginModal()">Cancelar</button>
                    <button class="btn btn-primary" onclick="login()">Ingresar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Product Modal -->
    <div id="productFormModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title" id="productFormTitle">Agregar Producto</h2>
                <button class="modal-close" onclick="closeProductFormModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="productForm" onsubmit="saveProduct(event)">
                <input type="hidden" id="productId">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Nombre del Producto *</label>
                        <input type="text" class="form-input" id="productName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Categor√≠a *</label>
                        <select class="form-input" id="productCategory" required>
                            <option value="">Seleccionar categor√≠a...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Descripci√≥n *</label>
                        <textarea class="form-textarea" id="productDescription" required></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Im√°genes (URLs separadas por coma)</label>
                        <input type="text" class="form-input" id="productImages" placeholder="https://ejemplo.com/imagen1.jpg, https://ejemplo.com/imagen2.jpg">
                        <p class="form-hint">Pega URLs de im√°genes separadas por comas. Para im√°genes locales, usa un servicio como Imgur o Cloudinary.</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Etiquetas (separadas por coma)</label>
                        <input type="text" class="form-input" id="productTags" placeholder="digestivo, natural, hierbas">
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                        <div class="form-group">
                            <label class="form-label">Precio (Gs) *</label>
                            <input type="number" class="form-input" id="productPrice" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Stock *</label>
                            <input type="number" class="form-input" id="productStock" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">SKU *</label>
                            <input type="text" class="form-input" id="productSku" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Unidad</label>
                            <input type="text" class="form-input" id="productUnit" placeholder="g, ml, cps">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Presentaci√≥n</label>
                        <input type="text" class="form-input" id="productPresentation" placeholder="100g, 200ml, 60 c√°psulas">
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="productFeatured">
                        <label for="productFeatured" class="form-label">Producto Destacado</label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeProductFormModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="saveProductBtn">Guardar Producto</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <script>
        // Estado de la aplicaci√≥n
        let products = [];
        let filteredProducts = [];
        let cart = [];
        let wishlist = [];
        let selectedCategory = '';
        let isAdmin = false;
        let editingProductId = null;

        // Credenciales de admin (en producci√≥n esto debe estar en backend)
        const ADMIN_CREDENTIALS = { username: 'dbaza', password: '1234' };

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            checkAdminSession();
            loadProducts();
            updateMetrics();
        });

        // Verificar sesi√≥n de admin
        function checkAdminSession() {
            const session = localStorage.getItem('kumi-admin-session');
            if (session) {
                const sessionData = JSON.parse(session);
                if (sessionData.isActive && (Date.now() - sessionData.timestamp < 24 * 60 * 60 * 1000)) {
                    activateAdminMode();
                } else {
                    localStorage.removeItem('kumi-admin-session');
                }
            }
        }

        // Cargar productos desde localStorage o sample si es primera vez
        function loadProducts() {
            setTimeout(() => {
                const savedProducts = localStorage.getItem('kumi-products');
                if (savedProducts) {
                    products = JSON.parse(savedProducts);
                } else {
                    products = [...sampleProducts];
                    saveProductsToStorage();
                }
                filteredProducts = [...products];
                renderCategories();
                renderProducts();
                updateMetrics();
                
                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('productsGrid').style.display = 'grid';
            }, 1000);
        }

        // Guardar productos en localStorage
        function saveProductsToStorage() {
            localStorage.setItem('kumi-products', JSON.stringify(products));
        }

        // Cargar desde localStorage
        function loadFromLocalStorage() {
            const savedCart = localStorage.getItem('kumi-cart');
            const savedWishlist = localStorage.getItem('kumi-wishlist');
            
            if (savedCart) cart = JSON.parse(savedCart);
            if (savedWishlist) wishlist = JSON.parse(savedWishlist);
            
            updateBadges();
        }

        // Guardar en localStorage
        function saveToLocalStorage() {
            localStorage.setItem('kumi-cart', JSON.stringify(cart));
            localStorage.setItem('kumi-wishlist', JSON.stringify(wishlist));
        }

        // Manejar acci√≥n del bot√≥n admin
        function handleAdminAction() {
            if (isAdmin) {
                logout();
            } else {
                showLoginModal();
            }
        }

        // Mostrar modal de login
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('show');
            document.getElementById('loginUsername').focus();
        }

        // Cerrar modal de login
        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('show');
            document.getElementById('loginError').classList.remove('show');
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
        }

        // Login
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                activateAdminMode();
                closeLoginModal();
                showToast('Acceso concedido. Modo administrador activado.', 'success');
            } else {
                const errorEl = document.getElementById('loginError');
                errorEl.textContent = 'Credenciales inv√°lidas. Usuario: dbaza, Contrase√±a: 1234';
                errorEl.classList.add('show');
            }
        }

        // Activar modo admin
        function activateAdminMode() {
            isAdmin = true;
            const adminBtn = document.getElementById('adminBtn');
            const adminBtnText = document.getElementById('adminBtnText');
            const adminBadge = document.getElementById('adminBadge');
            const fabAddProduct = document.getElementById('fabAddProduct');
            
            adminBtnText.textContent = 'Salir Admin';
            adminBadge.style.display = 'flex';
            fabAddProduct.classList.remove('hide');
            
            // Guardar sesi√≥n
            localStorage.setItem('kumi-admin-session', JSON.stringify({
                isActive: true,
                timestamp: Date.now()
            }));
            
            renderProducts(); // Re-render para mostrar controles de admin
        }

        // Logout
        function logout() {
            isAdmin = false;
            const adminBtn = document.getElementById('adminBtn');
            const adminBtnText = document.getElementById('adminBtnText');
            const adminBadge = document.getElementById('adminBadge');
            const fabAddProduct = document.getElementById('fabAddProduct');
            
            adminBtnText.textContent = 'Admin';
            adminBadge.style.display = 'none';
            fabAddProduct.classList.add('hide');
            
            // Limpiar sesi√≥n
            localStorage.removeItem('kumi-admin-session');
            
            renderProducts(); // Re-render para ocultar controles de admin
            showToast('Sesi√≥n de administrador cerrada.', 'warning');
        }

        // Mostrar modal de agregar producto
        function showAddProductModal() {
            editingProductId = null;
            document.getElementById('productFormTitle').textContent = 'Agregar Nuevo Producto';
            document.getElementById('productForm').reset();
            document.getElementById('productId').value = generateId();
            document.getElementById('productFormModal').classList.add('show');
            loadCategoriesInSelect();
        }

        // Mostrar modal de editar producto
        function showEditProductModal(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            editingProductId = productId;
            document.getElementById('productFormTitle').textContent = 'Editar Producto';
            document.getElementById('productId').value = product.id;
            document.getElementById('productName').value = product.nombre;
            document.getElementById('productCategory').value = product.categoria;
            document.getElementById('productDescription').value = product.descripcion;
            document.getElementById('productImages').value = product.imagenes.join(', ');
            document.getElementById('productTags').value = product.etiquetas.join(', ');
            document.getElementById('productPrice').value = product.precio;
            document.getElementById('productStock').value = product.stock;
            document.getElementById('productSku').value = product.sku;
            document.getElementById('productUnit').value = product.unidad || '';
            document.getElementById('productPresentation').value = product.presentacion || '';
            document.getElementById('productFeatured').checked = product.destacado || false;
            
            document.getElementById('productFormModal').classList.add('show');
            loadCategoriesInSelect();
        }

        // Cargar categor√≠as en el select del formulario
        function loadCategoriesInSelect() {
            const select = document.getElementById('productCategory');
            const categories = [...new Set(products.map(p => p.categoria))].sort();
            
            select.innerHTML = '<option value="">Seleccionar categor√≠a...</option>';
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                select.appendChild(option);
            });
            
            // Opci√≥n para agregar nueva categor√≠a
            const newOption = document.createElement('option');
            newOption.value = '__new__';
            newOption.textContent = '+ Agregar nueva categor√≠a...';
            select.appendChild(newOption);
            
            // Event listener para nueva categor√≠a
            select.onchange = function() {
                if (this.value === '__new__') {
                    const newCat = prompt('Ingrese el nombre de la nueva categor√≠a:');
                    if (newCat && newCat.trim()) {
                        const option = document.createElement('option');
                        option.value = newCat.trim();
                        option.textContent = newCat.trim();
                        option.selected = true;
                        select.insertBefore(option, select.lastElementChild);
                    } else {
                        this.value = '';
                    }
                }
            };
        }

        // Cerrar modal de producto
        function closeProductFormModal() {
            document.getElementById('productFormModal').classList.remove('show');
            editingProductId = null;
        }

        // Guardar producto
        function saveProduct(event) {
            event.preventDefault();
            
            const productData = {
                id: document.getElementById('productId').value,
                nombre: document.getElementById('productName').value.trim(),
                categoria: document.getElementById('productCategory').value,
                descripcion: document.getElementById('productDescription').value.trim(),
                imagenes: document.getElementById('productImages').value.split(',').map(url => url.trim()).filter(url => url),
                etiquetas: document.getElementById('productTags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                precio: parseInt(document.getElementById('productPrice').value) || 0,
                stock: parseInt(document.getElementById('productStock').value) || 0,
                sku: document.getElementById('productSku').value.trim(),
                unidad: document.getElementById('productUnit').value.trim(),
                presentacion: document.getElementById('productPresentation').value.trim(),
                destacado: document.getElementById('productFeatured').checked,
                creado: editingProductId ? products.find(p => p.id === editingProductId)?.creado : new Date().toISOString().split('T')[0]
            };
            
            // Validaci√≥n
            if (!productData.nombre || !productData.categoria || !productData.descripcion || !productData.sku) {
                showToast('Por favor completa todos los campos obligatorios.', 'error');
                return;
            }
            
            if (editingProductId) {
                // Editar producto existente
                const index = products.findIndex(p => p.id === editingProductId);
                if (index !== -1) {
                    products[index] = { ...productData };
                }
                showToast('Producto actualizado correctamente.', 'success');
            } else {
                // Agregar nuevo producto
                products.push(productData);
                showToast('Producto agregado correctamente.', 'success');
            }
            
            saveProductsToStorage();
            filteredProducts = [...products];
            renderCategories();
            renderProducts();
            updateMetrics();
            closeProductFormModal();
        }

        // Eliminar producto
        function deleteProduct(productId) {
            if (!confirm('¬øEst√°s seguro de eliminar este producto? Esta acci√≥n no se puede deshacer.')) {
                return;
            }
            
            products = products.filter(p => p.id !== productId);
            saveProductsToStorage();
            filteredProducts = filteredProducts.filter(p => p.id !== productId);
            
            renderCategories();
            renderProducts();
            updateMetrics();
            showToast('Producto eliminado correctamente.', 'warning');
        }

        // Generar ID √∫nico
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // [FUNCIONES PREVIAS MANTENIDAS]
        function renderCategories() { /* ... */ }
        function selectCategory(category) { /* ... */ }
        function filterProducts() { /* ... */ }
        function renderProducts() { /* ... */ }
        function updateMetrics() { /* ... */ }
        function updateBadges() { /* ... */ }
        function toggleCart() { /* ... */ }
        function toggleWishlist() { /* ... */ }
        function closeModal() { /* ... */ }
        function showToast(message, type = 'success') { /* ... */ }
        function clearFilters() { /* ... */ }

        // [IMPLEMENTACI√ìN DE FUNCIONES PREVIAS]
        function renderCategories() {
            const categories = [...new Set(products.map(p => p.categoria))].sort();
            const container = document.getElementById('categoryChips');
            
            container.innerHTML = `
                <div class="chip ${selectedCategory === '' ? 'active' : ''}" onclick="selectCategory('')">
                    Todas
                </div>
            `;
            
            categories.forEach(category => {
                const chip = document.createElement('div');
                chip.className = `chip ${selectedCategory === category ? 'active' : ''}`;
                chip.textContent = category;
                chip.onclick = () => selectCategory(category);
                container.appendChild(chip);
            });
        }

        function selectCategory(category) {
            selectedCategory = category;
            renderCategories();
            filterProducts();
        }

        function filterProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const sortBy = document.getElementById('sortSelect').value;
            
            filteredProducts = products.filter(product => {
                const matchesSearch = !searchTerm || 
                    product.nombre.toLowerCase().includes(searchTerm) ||
                    product.descripcion.toLowerCase().includes(searchTerm) ||
                    product.categoria.toLowerCase().includes(searchTerm) ||
                    product.etiquetas.some(tag => tag.toLowerCase().includes(searchTerm));
                
                const matchesCategory = !selectedCategory || product.categoria === selectedCategory;
                
                return matchesSearch && matchesCategory;
            });
            
            switch(sortBy) {
                case 'name_asc': filteredProducts.sort((a, b) => a.nombre.localeCompare(b.nombre)); break;
                case 'name_desc': filteredProducts.sort((a, b) => b.nombre.localeCompare(a.nombre)); break;
                case 'price_asc': filteredProducts.sort((a, b) => (a.precio || 0) - (b.precio || 0)); break;
                case 'price_desc': filteredProducts.sort((a, b) => (b.precio || 0) - (a.precio || 0)); break;
            }
            
            renderProducts();
        }

        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            const emptyState = document.getElementById('emptyState');
            
            if (filteredProducts.length === 0) {
                grid.style.display = 'none';
                emptyState.classList.add('show');
                document.getElementById('resultsCount').textContent = '0 producto(s) encontrado(s)';
                return;
            }
            
            grid.style.display = 'grid';
            emptyState.classList.remove('show');
            document.getElementById('resultsCount').textContent = `${filteredProducts.length} producto(s) encontrado(s)`;
            
            grid.innerHTML = filteredProducts.map((product, index) => {
                const isInCart = cart.some(item => item.id === product.id);
                const isInWishlist = wishlist.some(item => item.id === product.id);
                
                return `
                    <div class="product-card" style="animation-delay: ${index * 0.05}s">
                        <div class="product-image-container">
                            <img src="${product.imagenes[0] || 'https://picsum.photos/seed/default/400/300.jpg'}" alt="${product.nombre}" class="product-image">
                            ${product.destacado ? '<div class="product-badge">Destacado</div>' : ''}
                            <div class="product-overlay">
                                <div class="overlay-actions">
                                    <button class="overlay-btn" onclick="addToCart('${product.id}')" ${isInCart ? 'disabled' : ''}>
                                        <i class="fas fa-cart-plus"></i> ${isInCart ? '‚úì' : 'Agregar'}
                                    </button>
                                    <button class="overlay-btn-wishlist ${isInWishlist ? 'active' : ''}" onclick="toggleWishlistItem('${product.id}')">
                                        <i class="fas fa-heart"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="product-content">
                            <div class="product-header">
                                <span class="product-category">${product.categoria}</span>
                                <span class="product-price">Gs. ${product.precio.toLocaleString()}</span>
                            </div>
                            <h3 class="product-name">${product.nombre}</h3>
                            <p class="product-description">${product.descripcion}</p>
                            <div class="product-tags">
                                ${product.etiquetas.slice(0, 3).map(tag => `<span class="product-tag">${tag}</span>`).join('')}
                            </div>
                            <div class="product-actions">
                                <button class="product-action-btn" onclick="showProductModal('${product.id}')">
                                    <i class="fas fa-info-circle"></i> Detalles
                                </button>
                                <button class="product-action-btn" onclick="addToCart('${product.id}')" ${isInCart ? 'disabled' : ''}>
                                    <i class="fas fa-shopping-cart"></i> ${isInCart ? '‚úì Agregado' : 'Agregar'}
                                </button>
                            </div>
                            ${isAdmin ? `
                                <div class="admin-product-actions">
                                    <button class="product-action-btn admin-btn-edit" onclick="showEditProductModal('${product.id}')">
                                        <i class="fas fa-edit"></i> Editar
                                    </button>
                                    <button class="product-action-btn admin-btn-delete" onclick="deleteProduct('${product.id}')">
                                        <i class="fas fa-trash"></i> Eliminar
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateMetrics() {
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalCategories').textContent = [...new Set(products.map(p => p.categoria))].length;
            document.getElementById('cartCount').textContent = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
        }

        function updateBadges() {
            document.getElementById('cartBadge').textContent = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
            document.getElementById('wishlistBadge').textContent = wishlist.length;
        }

        function showToast(message, type = 'success') {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast show ${type === 'error' ? 'toast-error' : type === 'warning' ? 'toast-warning' : ''}`;
            toast.innerHTML = `
                <div class="toast-content">
                    <div class="toast-icon">
                        <i class="fas ${type === 'error' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-check'}"></i>
                    </div>
                    <div class="toast-message">${message}</div>
                </div>
            `;
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('sortSelect').value = 'relevance';
            selectedCategory = '';
            filterProducts();
        }

        // [FUNCIONES CRUD Y MODALES PREVIOS MANTENIDOS]
        function addToCart(productId) { /* ... */ }
        function removeFromCart(productId) { /* ... */ }
        function toggleWishlistItem(productId) { /* ... */ }
        function removeFromWishlist(productId) { /* ... */ }
        function showProductModal(productId) { /* ... */ }
        function closeModal() { document.querySelectorAll('.modal').forEach(m => m.classList.remove('show')); }
    </script>
</body>
</html>
